version: "3.7"
services:
  corda:
    image: nutsfoundation/nuts-consent-cordapp:release-0.13.2-dev
    networks:
      - nuts
    ports:
      - "22222:2222"
      - "27886:7886"
    volumes:
      - "./node/:/opt/nuts/"
    command: "java -jar /opt/nuts/corda-4.4.jar --network-root-truststore-password=changeit --log-to-console"
    restart: "on-failure"
  bridge:
    image: nutsfoundation/nuts-consent-bridge:release-0.13.3-dev
    environment:
      SPRING_SERVER_ADDRESS: bridge
    networks:
      - nuts
    ports:
      - "28080:8080"
    volumes:
      - "./node/application.properties:/opt/nuts/application.properties"
    restart: "on-failure"
  nuts-service-space:
    image: nutsfoundation/nuts-service-space:release-0.13.7
    environment:
      NUTS_CONFIGFILE: /opt/nuts/nuts.yaml
    networks:
      nuts:
        aliases:
          - registry
    ports:
      - "21323:1323"
    volumes:
      - "./node/nuts.yaml:/opt/nuts/nuts.yaml"
      - "./node/keys:/opt/nuts/keys"
    restart: "on-failure"
networks:
  nuts:
    name: nutsp
